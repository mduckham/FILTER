{"ast":null,"code":"var _jsxFileName = \"/Users/E113938/Library/CloudStorage/OneDrive-RMITUniversity/My Mac Folders/2025/FILTER Project/FILTER/Map Dashboard/Map Demonstrator/src/components/map.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\nimport { GoogleGenerativeAI } from '@google/generative-ai'; // Import the Google AI SDK\n\n// --- LLM API Setup ---\n// IMPORTANT: Store your API key in an environment variable.\n// Create a .env.local file in your project root and add:\n// REACT_APP_GEMINI_API_KEY='YOUR_API_KEY_HERE'\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst genAI = new GoogleGenerativeAI(process.env.REACT_APP_GEMINI_API_KEY);\n\n// --- Legend Component ---\n// A reusable component to display the map legend.\nconst Legend = ({\n  title,\n  items\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'absolute',\n      bottom: '2rem',\n      right: '1rem',\n      backgroundColor: 'white',\n      padding: '1rem',\n      borderRadius: '0.5rem',\n      boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\n      zIndex: 10,\n      width: '180px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n      style: {\n        margin: '0 0 0.5rem 0',\n        fontWeight: 'bold'\n      },\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 7\n    }, this), items.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        marginBottom: '0.25rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          backgroundColor: item.color,\n          width: '18px',\n          height: '18px',\n          display: 'inline-block',\n          marginRight: '0.5rem',\n          border: '1px solid #ccc'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: item.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 11\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 16,\n    columnNumber: 5\n  }, this);\n};\n\n// --- Map Component ---\n// This version visualizes all five of your provided datasets.\n_c = Legend;\nexport default function Map() {\n  _s();\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n\n  // State for the new search functionality\n  const [searchText, setSearchText] = useState('');\n  const [indicators, setIndicators] = useState([]);\n  const [selectedIndicator, setSelectedIndicator] = useState(null);\n  const [showIndicators, setShowIndicators] = useState(false);\n\n  // State for the dynamically generated description\n  const [dynamicDescription, setDynamicDescription] = useState('');\n  const [isDescriptionLoading, setIsDescriptionLoading] = useState(false);\n\n  // --- Data for the Legends ---\n  const legendData = {\n    Employment: {\n      title: 'Employment (Total)',\n      items: [{\n        color: '#edf8e9',\n        label: '0 - 500'\n      }, {\n        color: '#c7e9c0',\n        label: '501 - 1000'\n      }, {\n        color: '#a1d99b',\n        label: '1001 - 1500'\n      }, {\n        color: '#74c476',\n        label: '1501 - 2000'\n      }, {\n        color: '#31a354',\n        label: '2001 - 2500'\n      }, {\n        color: '#006d2c',\n        label: '> 2500'\n      }]\n    },\n    Education: {\n      title: 'Education (Total)',\n      items: [{\n        color: '#fee5d9',\n        label: '0 - 250'\n      }, {\n        color: '#fcbba1',\n        label: '251 - 500'\n      }, {\n        color: '#fc9272',\n        label: '501 - 750'\n      }, {\n        color: '#fb6a4a',\n        label: '751 - 1000'\n      }, {\n        color: '#ef3b2c',\n        label: '1001 - 1500'\n      }, {\n        color: '#cb181d',\n        label: '> 1500'\n      }]\n    },\n    'Place of Birth': {\n      title: 'Place of Birth (Total)',\n      items: [{\n        color: '#feedde',\n        label: '0 - 500'\n      }, {\n        color: '#fdd0a2',\n        label: '501 - 1000'\n      }, {\n        color: '#fdae6b',\n        label: '1001 - 1500'\n      }, {\n        color: '#fd8d3c',\n        label: '1501 - 2000'\n      }, {\n        color: '#f16913',\n        label: '2001 - 2500'\n      }, {\n        color: '#d94801',\n        label: '> 2500'\n      }]\n    },\n    Income: {\n      title: 'Income (Total)',\n      items: [{\n        color: '#f2f0f7',\n        label: '0 - 500'\n      }, {\n        color: '#dadaeb',\n        label: '500 - 1000'\n      }, {\n        color: '#bcbddc',\n        label: '1000 - 2000'\n      }, {\n        color: '#9e9ac8',\n        label: '2000 - 3000'\n      }, {\n        color: '#756bb1',\n        label: '3000 - 3500'\n      }, {\n        color: '#54278f',\n        label: '> 3500'\n      }]\n    },\n    Occupation: {\n      title: 'Occupation (Total)',\n      items: [{\n        color: '#f7fbff',\n        label: '0 - 250'\n      }, {\n        color: '#deebf7',\n        label: '251 - 500'\n      }, {\n        color: '#c6dbef',\n        label: '501 - 750'\n      }, {\n        color: '#9ecae1',\n        label: '751 - 1000'\n      }, {\n        color: '#6baed6',\n        label: '1001 - 1500'\n      }, {\n        color: '#4292c6',\n        label: '1501 - 2000'\n      }, {\n        color: '#2171b5',\n        label: '2001 - 2500'\n      }, {\n        color: '#084594',\n        label: '> 2500'\n      }]\n    }\n  };\n\n  // --- Data configuration for each indicator ---\n  const indicatorConfig = {\n    Employment: {\n      path: '/data/employment-fb-sa1.geojson',\n      property: 'employment-VIC_Total'\n    },\n    Education: {\n      path: '/data/education-fb-sa1.geojson',\n      property: 'Education-VIC_Total'\n    },\n    'Place of Birth': {\n      path: '/data/POB-fb-sa1.geojson',\n      property: 'POB-VIC1_Total'\n    },\n    Income: {\n      path: '/data/income-fb-sa1.geojson',\n      property: 'Income-VIC1_Total'\n    },\n    Occupation: {\n      path: '/data/occupation-fb-sa1.geojson',\n      property: 'Occupation-VIC_Total'\n    }\n  };\n\n  // --- Main useEffect for Map Initialization ---\n  useEffect(() => {\n    if (map.current) return;\n    if (!mapContainer.current) return;\n    map.current = new maplibregl.Map({\n      container: mapContainer.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      scrollZoom: false,\n      boxZoom: false,\n      dragRotate: false,\n      dragPan: false,\n      keyboard: false,\n      doubleClickZoom: false,\n      touchZoomRotate: false\n    });\n    map.current.on('error', e => {\n      console.error('A map error occurred:', e.error ? e.error.message : 'Unknown error');\n    });\n    map.current.on('load', () => {\n      const bounds = [[144.888484, -37.853104], [144.956026, -37.814502]];\n      map.current.fitBounds(bounds, {\n        padding: 20\n      });\n\n      // --- Data Sources ---\n      const sources = [{\n        name: 'base-outline',\n        path: '/data/fb-sa1-2021-WGS84-boundary.geojson'\n      }, {\n        name: 'employment',\n        path: '/data/employment-fb-sa1.geojson'\n      }, {\n        name: 'education',\n        path: '/data/education-fb-sa1.geojson'\n      }, {\n        name: 'pob',\n        path: '/data/POB-fb-sa1.geojson'\n      }, {\n        name: 'income',\n        path: '/data/income-fb-sa1.geojson'\n      }, {\n        name: 'occupation',\n        path: '/data/occupation-fb-sa1.geojson'\n      }, {\n        name: 'precincts',\n        path: '/data/fb-precincts-official-boundary.geojson'\n      }];\n      sources.forEach(s => {\n        map.current.addSource(`${s.name}-data-source`, {\n          type: 'geojson',\n          data: s.path\n        });\n      });\n\n      // --- Indicator Layers Configuration ---\n      const layers = [{\n        id: 'employment-layer',\n        indicatorName: 'Employment',\n        source: 'employment-data-source',\n        property: indicatorConfig.Employment.property,\n        colors: legendData.Employment.items.map(i => i.color),\n        stops: [0, 500, 1000, 1500, 2000, 2500]\n      }, {\n        id: 'education-layer',\n        indicatorName: 'Education',\n        source: 'education-data-source',\n        property: indicatorConfig.Education.property,\n        colors: legendData.Education.items.map(i => i.color),\n        stops: [0, 250, 500, 750, 1000, 1500]\n      }, {\n        id: 'pob-layer',\n        indicatorName: 'Place of Birth',\n        source: 'pob-data-source',\n        property: indicatorConfig['Place of Birth'].property,\n        colors: legendData['Place of Birth'].items.map(i => i.color),\n        stops: [0, 500, 1000, 1500, 2000, 2500]\n      }, {\n        id: 'income-layer',\n        indicatorName: 'Income',\n        source: 'income-data-source',\n        property: indicatorConfig.Income.property,\n        colors: legendData.Income.items.map(i => i.color),\n        stops: [0, 500, 1000, 2000, 3000, 3500]\n      }, {\n        id: 'occupation-layer',\n        indicatorName: 'Occupation',\n        source: 'occupation-data-source',\n        property: indicatorConfig.Occupation.property,\n        colors: legendData.Occupation.items.map(i => i.color),\n        stops: [0, 250, 500, 750, 1000, 1500, 2000, 2500]\n      }];\n\n      // --- REVISION START: REORDERED LAYER ADDITION ---\n      // This section is updated to control the layer stacking order precisely as requested:\n      // 1. Precincts (Top)\n      // 2. SA1 (Middle)\n      // 3. Basemap (Bottom)\n\n      // The order in which we call `addLayer` determines the stacking.\n      // Layers added later are drawn on top of layers added earlier.\n      // By not providing a second argument (`beforeId`), each layer is added\n      // to the top of the current style stack.\n\n      // 1. Add the SA1 'fill' layers first. They will be at the bottom of our custom layers.\n      layers.forEach(layer => {\n        const colorStops = layer.stops.flatMap((stop, i) => [stop, layer.colors[i] || layer.colors[layer.colors.length - 1]]);\n        map.current.addLayer({\n          id: layer.id,\n          type: 'fill',\n          source: layer.source,\n          layout: {\n            visibility: 'none'\n          },\n          // Start with layers hidden\n          paint: {\n            'fill-color': ['interpolate', ['linear'], ['to-number', ['get', layer.property]], ...colorStops],\n            'fill-opacity': 0.75\n          }\n        });\n\n        // Add click listener for each layer to show a popup\n        map.current.on('click', layer.id, e => {\n          const feature = e.features[0];\n          if (feature) {\n            const regionName = feature.properties['SA1_CODE21'];\n            const value = feature.properties[layer.property];\n            const formattedValue = !isNaN(value) ? Number(value).toLocaleString() : 'N/A';\n            new maplibregl.Popup().setLngLat(e.lngLat).setHTML(`\n                <div style=\"font-family: sans-serif; padding: 5px; text-align: left;\">\n                  <h4 style=\"margin: 0 0 5px 0; font-weight: bold;\">SA1: ${regionName}</h4>\n                  <strong>${layer.indicatorName}:</strong> ${formattedValue}\n                </div>\n              `).addTo(map.current);\n          }\n        });\n\n        // Change cursor to pointer on hover\n        map.current.on('mouseenter', layer.id, () => {\n          map.current.getCanvas().style.cursor = 'pointer';\n        });\n        map.current.on('mouseleave', layer.id, () => {\n          map.current.getCanvas().style.cursor = '';\n        });\n      });\n\n      // 2. Add the SA1 outline layer. This is added on top of the SA1 fills.\n      // Together, these two form the \"SA1 Layer\".\n      map.current.addLayer({\n        id: 'base-outline-layer',\n        type: 'line',\n        source: 'base-outline-data-source',\n        paint: {\n          'line-color': '#444',\n          'line-width': 1\n        }\n      });\n\n      // 3. Add the precincts outline layer LAST. This is added on top of the SA1 layer,\n      // making it the topmost layer on the map.\n      map.current.addLayer({\n        id: 'precincts-outline-layer',\n        type: 'line',\n        source: 'precincts-data-source',\n        paint: {\n          'line-color': '#0868ac',\n          // A distinct blue\n          'line-width': 2.5,\n          'line-opacity': 0.9\n        }\n      });\n      // --- REVISION END ---\n    });\n    return () => {\n      if (map.current) {\n        map.current.remove();\n        map.current = null;\n      }\n    };\n  }, []);\n\n  // --- useEffect to Toggle Layer Visibility ---\n  useEffect(() => {\n    if (!map.current || !map.current.isStyleLoaded()) return;\n    const allLayerIds = ['employment-layer', 'education-layer', 'pob-layer', 'income-layer', 'occupation-layer'];\n    const selectedLayerId = selectedIndicator ? `${selectedIndicator.toLowerCase().replace(/ /g, '-')}-layer` : null;\n\n    // The base SA1 outline should be visible whenever any indicator is selected\n    if (map.current.getLayer('base-outline-layer')) {\n      map.current.setLayoutProperty('base-outline-layer', 'visibility', selectedIndicator ? 'visible' : 'none');\n    }\n    allLayerIds.forEach(layerId => {\n      if (map.current.getLayer(layerId)) {\n        map.current.setLayoutProperty(layerId, 'visibility', layerId === selectedLayerId ? 'visible' : 'none');\n      }\n    });\n  }, [selectedIndicator]);\n\n  // --- [REVISED] useEffect to generate description with the Gemini LLM ---\n  useEffect(() => {\n    if (!selectedIndicator) {\n      setDynamicDescription('');\n      return;\n    }\n    const generateLLMDescription = async () => {\n      setIsDescriptionLoading(true);\n      setDynamicDescription('');\n      const config = indicatorConfig[selectedIndicator];\n      if (!config) {\n        setIsDescriptionLoading(false);\n        return;\n      }\n      try {\n        // Step 1: Fetch and analyze the data to get key statistics\n        const response = await fetch(config.path);\n        const geojsonData = await response.json();\n        let minFeature = null;\n        let maxFeature = null;\n        let sum = 0;\n        let count = 0;\n        geojsonData.features.forEach(feature => {\n          const value = Number(feature.properties[config.property]);\n          if (!isNaN(value)) {\n            if (minFeature === null || value < Number(minFeature.properties[config.property])) {\n              minFeature = feature;\n            }\n            if (maxFeature === null || value > Number(maxFeature.properties[config.property])) {\n              maxFeature = feature;\n            }\n            sum += value;\n            count++;\n          }\n        });\n        if (count === 0) {\n          setDynamicDescription('No valid data found to generate a description.');\n          setIsDescriptionLoading(false);\n          return;\n        }\n        const average = (sum / count).toFixed(2);\n        const minValue = Number(minFeature.properties[config.property]);\n        const maxValue = Number(maxFeature.properties[config.property]);\n        const minRegion = minFeature.properties['SA1_CODE21'];\n        const maxRegion = maxFeature.properties['SA1_CODE21'];\n\n        // Step 2: Create a prompt for the LLM\n        const prompt = `\n          You are a concise data analyst for a public-facing dashboard.\n          Based on the following data for the \"${selectedIndicator}\" indicator in Melbourne's inner suburbs, write a short, engaging summary (around 50-70 words).\n          Do not just list the numbers; provide a brief insight into what the data shows (e.g., \"a significant disparity,\" \"a wide range,\" \"a concentration of...\").\n          \n          Key Statistics:\n          - Highest value: ${maxValue.toLocaleString()} (in SA1 area ${maxRegion})\n          - Lowest value: ${minValue.toLocaleString()} (in SA1 area ${minRegion})\n          - Average value across all areas: ${Number(average).toLocaleString()}\n        `;\n\n        // Step 3: Call the Gemini API\n        const model = genAI.getGenerativeModel({\n          model: \"gemini-1.5-flash-latest\"\n        });\n        const result = await model.generateContent(prompt);\n        const llmResponse = await result.response;\n        const text = llmResponse.text();\n        setDynamicDescription(text);\n      } catch (error) {\n        console.error(\"Error generating LLM description:\", error);\n        setDynamicDescription('An error occurred while generating the description. Please check your API key and network connection.');\n      } finally {\n        setIsDescriptionLoading(false);\n      }\n    };\n    generateLLMDescription();\n  }, [selectedIndicator]); // Re-run when selectedIndicator changes\n\n  // --- UI Handlers ---\n  const handleSearchClick = () => {\n    setIndicators(['Employment', 'Education', 'Place of Birth', 'Income', 'Occupation']);\n    setShowIndicators(true);\n  };\n  const handleIndicatorSelect = indicator => {\n    setSelectedIndicator(prev => prev === indicator ? null : indicator);\n  };\n\n  // --- Component Render ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      width: '100%',\n      height: 'calc(100vh - 78px)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'relative',\n        flex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ref: mapContainer,\n        style: {\n          position: 'absolute',\n          width: '100%',\n          height: '100%'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'absolute',\n          top: '1rem',\n          left: '1rem',\n          backgroundColor: 'white',\n          padding: '1rem',\n          borderRadius: '0.5rem',\n          boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\n          width: '288px',\n          zIndex: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            fontSize: '1.125rem',\n            fontWeight: 'bold',\n            marginBottom: '1rem'\n          },\n          children: \"I'm interested in ...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'column',\n            gap: '0.75rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: searchText,\n            onChange: e => setSearchText(e.target.value),\n            placeholder: \"e.g., 'jobs' or 'housing'\",\n            style: {\n              padding: '0.5rem',\n              border: '1px solid #D1D5DB',\n              borderRadius: '0.375rem',\n              outline: 'none'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSearchClick,\n            style: {\n              backgroundColor: '#2563EB',\n              color: 'white',\n              fontWeight: 600,\n              padding: '0.5rem 1rem',\n              borderRadius: '0.375rem',\n              border: 'none',\n              cursor: 'pointer'\n            },\n            children: \"Search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), showIndicators && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '1rem',\n            paddingTop: '1rem',\n            borderTop: '1px solid #E5E7EB'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              fontWeight: 600,\n              color: '#1F2937',\n              marginBottom: '0.5rem'\n            },\n            children: \"Suggested Indicators\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              flexDirection: 'column',\n              gap: '0.5rem'\n            },\n            children: indicators.map(indicator => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                id: indicator,\n                name: \"indicator\",\n                checked: selectedIndicator === indicator,\n                onChange: () => handleIndicatorSelect(indicator),\n                style: {\n                  height: '1rem',\n                  width: '1rem'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                htmlFor: indicator,\n                style: {\n                  marginLeft: '0.75rem',\n                  fontSize: '0.875rem',\n                  color: '#374151'\n                },\n                children: indicator\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 21\n              }, this)]\n            }, indicator, true, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this), selectedIndicator && legendData[selectedIndicator] && /*#__PURE__*/_jsxDEV(Legend, {\n        title: legendData[selectedIndicator].title,\n        items: legendData[selectedIndicator].items\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '320px',\n        backgroundColor: '#f8f9fa',\n        padding: '1.5rem',\n        borderLeft: '1px solid #dee2e6',\n        overflowY: 'auto'\n      },\n      children: selectedIndicator ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            fontSize: '1.1rem',\n            fontWeight: 600,\n            color: '#495057',\n            marginBottom: '0.75rem'\n          },\n          children: selectedIndicator\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 13\n        }, this), isDescriptionLoading ? /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '0.95rem',\n            color: '#6c757d',\n            fontStyle: 'italic'\n          },\n          children: \"\\uD83E\\uDD16 Generating AI description...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            fontSize: '0.95rem',\n            color: '#6c757d',\n            lineHeight: 1.6\n          },\n          children: dynamicDescription\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          fontSize: '0.95rem',\n          color: '#6c757d',\n          fontStyle: 'italic'\n        },\n        children: \"Select an indicator from the panel on the left to see its description.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 402,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 346,\n    columnNumber: 5\n  }, this);\n}\n_s(Map, \"lHfWYBX/Omf6ibH61MB6lx7bTLc=\");\n_c2 = Map;\nvar _c, _c2;\n$RefreshReg$(_c, \"Legend\");\n$RefreshReg$(_c2, \"Map\");","map":{"version":3,"names":["React","useState","useEffect","useRef","maplibregl","GoogleGenerativeAI","jsxDEV","_jsxDEV","genAI","process","env","REACT_APP_GEMINI_API_KEY","Legend","title","items","style","position","bottom","right","backgroundColor","padding","borderRadius","boxShadow","zIndex","width","children","margin","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","map","item","index","display","alignItems","marginBottom","color","height","marginRight","border","label","_c","Map","_s","mapContainer","searchText","setSearchText","indicators","setIndicators","selectedIndicator","setSelectedIndicator","showIndicators","setShowIndicators","dynamicDescription","setDynamicDescription","isDescriptionLoading","setIsDescriptionLoading","legendData","Employment","Education","Income","Occupation","indicatorConfig","path","property","current","container","scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","on","e","console","error","message","bounds","fitBounds","sources","name","forEach","s","addSource","type","data","layers","id","indicatorName","source","colors","i","stops","layer","colorStops","flatMap","stop","length","addLayer","layout","visibility","paint","feature","features","regionName","properties","value","formattedValue","isNaN","Number","toLocaleString","Popup","setLngLat","lngLat","setHTML","addTo","getCanvas","cursor","remove","isStyleLoaded","allLayerIds","selectedLayerId","toLowerCase","replace","getLayer","setLayoutProperty","layerId","generateLLMDescription","config","response","fetch","geojsonData","json","minFeature","maxFeature","sum","count","average","toFixed","minValue","maxValue","minRegion","maxRegion","prompt","model","getGenerativeModel","result","generateContent","llmResponse","text","handleSearchClick","handleIndicatorSelect","indicator","prev","flex","ref","top","left","fontSize","flexDirection","gap","onChange","target","placeholder","outline","onClick","marginTop","paddingTop","borderTop","checked","htmlFor","marginLeft","borderLeft","overflowY","fontStyle","lineHeight","_c2","$RefreshReg$"],"sources":["/Users/E113938/Library/CloudStorage/OneDrive-RMITUniversity/My Mac Folders/2025/FILTER Project/FILTER/Map Dashboard/Map Demonstrator/src/components/map.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\nimport { GoogleGenerativeAI } from '@google/generative-ai'; // Import the Google AI SDK\n\n// --- LLM API Setup ---\n// IMPORTANT: Store your API key in an environment variable.\n// Create a .env.local file in your project root and add:\n// REACT_APP_GEMINI_API_KEY='YOUR_API_KEY_HERE'\nconst genAI = new GoogleGenerativeAI(process.env.REACT_APP_GEMINI_API_KEY);\n\n// --- Legend Component ---\n// A reusable component to display the map legend.\nconst Legend = ({ title, items }) => {\n  return (\n    <div style={{\n      position: 'absolute',\n      bottom: '2rem',\n      right: '1rem',\n      backgroundColor: 'white',\n      padding: '1rem',\n      borderRadius: '0.5rem',\n      boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\n      zIndex: 10,\n      width: '180px'\n    }}>\n      <h4 style={{ margin: '0 0 0.5rem 0', fontWeight: 'bold' }}>{title}</h4>\n      {items.map((item, index) => (\n        <div key={index} style={{ display: 'flex', alignItems: 'center', marginBottom: '0.25rem' }}>\n          <span style={{\n            backgroundColor: item.color,\n            width: '18px',\n            height: '18px',\n            display: 'inline-block',\n            marginRight: '0.5rem',\n            border: '1px solid #ccc'\n          }}></span>\n          <span>{item.label}</span>\n        </div>\n      ))}\n    </div>\n  );\n};\n\n// --- Map Component ---\n// This version visualizes all five of your provided datasets.\nexport default function Map() {\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n\n  // State for the new search functionality\n  const [searchText, setSearchText] = useState('');\n  const [indicators, setIndicators] = useState([]);\n  const [selectedIndicator, setSelectedIndicator] = useState(null);\n  const [showIndicators, setShowIndicators] = useState(false);\n  \n  // State for the dynamically generated description\n  const [dynamicDescription, setDynamicDescription] = useState('');\n  const [isDescriptionLoading, setIsDescriptionLoading] = useState(false);\n\n  // --- Data for the Legends ---\n  const legendData = {\n    Employment: {\n      title: 'Employment (Total)',\n      items: [ { color: '#edf8e9', label: '0 - 500' }, { color: '#c7e9c0', label: '501 - 1000' }, { color: '#a1d99b', label: '1001 - 1500' }, { color: '#74c476', label: '1501 - 2000' }, { color: '#31a354', label: '2001 - 2500' }, { color: '#006d2c', label: '> 2500' } ]\n    },\n    Education: {\n      title: 'Education (Total)',\n      items: [ { color: '#fee5d9', label: '0 - 250' }, { color: '#fcbba1', label: '251 - 500' }, { color: '#fc9272', label: '501 - 750' }, { color: '#fb6a4a', label: '751 - 1000' }, { color: '#ef3b2c', label: '1001 - 1500' }, { color: '#cb181d', label: '> 1500' } ]\n    },\n    'Place of Birth': {\n      title: 'Place of Birth (Total)',\n      items: [ { color: '#feedde', label: '0 - 500' }, { color: '#fdd0a2', label: '501 - 1000' }, { color: '#fdae6b', label: '1001 - 1500' }, { color: '#fd8d3c', label: '1501 - 2000' }, { color: '#f16913', label: '2001 - 2500' }, { color: '#d94801', label: '> 2500' } ]\n    },\n    Income: {\n        title: 'Income (Total)',\n        items: [ { color: '#f2f0f7', label: '0 - 500' }, { color: '#dadaeb', label: '500 - 1000' }, { color: '#bcbddc', label: '1000 - 2000' }, { color: '#9e9ac8', label: '2000 - 3000' }, { color: '#756bb1', label: '3000 - 3500' }, { color: '#54278f', label: '> 3500' } ]\n    },\n    Occupation: {\n      title: 'Occupation (Total)',\n      items: [ { color: '#f7fbff', label: '0 - 250' }, { color: '#deebf7', label: '251 - 500' }, { color: '#c6dbef', label: '501 - 750' }, { color: '#9ecae1', label: '751 - 1000' }, { color: '#6baed6', label: '1001 - 1500' }, { color: '#4292c6', label: '1501 - 2000' }, { color: '#2171b5', label: '2001 - 2500' }, { color: '#084594', label: '> 2500' } ]\n    }\n  };\n\n  // --- Data configuration for each indicator ---\n  const indicatorConfig = {\n    Employment: { path: '/data/employment-fb-sa1.geojson', property: 'employment-VIC_Total' },\n    Education: { path: '/data/education-fb-sa1.geojson', property: 'Education-VIC_Total' },\n    'Place of Birth': { path: '/data/POB-fb-sa1.geojson', property: 'POB-VIC1_Total' },\n    Income: { path: '/data/income-fb-sa1.geojson', property: 'Income-VIC1_Total' },\n    Occupation: { path: '/data/occupation-fb-sa1.geojson', property: 'Occupation-VIC_Total' }\n  };\n\n\n  // --- Main useEffect for Map Initialization ---\n  useEffect(() => {\n    if (map.current) return;\n    if (!mapContainer.current) return;\n\n    map.current = new maplibregl.Map({\n      container: mapContainer.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      scrollZoom: false, boxZoom: false, dragRotate: false, dragPan: false,\n      keyboard: false, doubleClickZoom: false, touchZoomRotate: false,\n    });\n\n    map.current.on('error', (e) => {\n        console.error('A map error occurred:', e.error ? e.error.message : 'Unknown error');\n    });\n\n    map.current.on('load', () => {\n      const bounds = [\n        [144.888484, -37.853104],\n        [144.956026, -37.814502 ]\n      ];\n      map.current.fitBounds(bounds, { padding: 20 });\n\n      // --- Data Sources ---\n      const sources = [\n        { name: 'base-outline', path: '/data/fb-sa1-2021-WGS84-boundary.geojson' },\n        { name: 'employment', path: '/data/employment-fb-sa1.geojson' },\n        { name: 'education', path: '/data/education-fb-sa1.geojson' },\n        { name: 'pob', path: '/data/POB-fb-sa1.geojson' },\n        { name: 'income', path: '/data/income-fb-sa1.geojson' },\n        { name: 'occupation', path: '/data/occupation-fb-sa1.geojson' },\n        { name: 'precincts', path: '/data/fb-precincts-official-boundary.geojson' },\n      ];\n      sources.forEach(s => {\n        map.current.addSource(`${s.name}-data-source`, { type: 'geojson', data: s.path });\n      });\n      \n      // --- Indicator Layers Configuration ---\n      const layers = [\n        { id: 'employment-layer', indicatorName: 'Employment', source: 'employment-data-source', property: indicatorConfig.Employment.property, colors: legendData.Employment.items.map(i => i.color), stops: [0, 500, 1000, 1500, 2000, 2500] },\n        { id: 'education-layer', indicatorName: 'Education', source: 'education-data-source', property: indicatorConfig.Education.property, colors: legendData.Education.items.map(i => i.color), stops: [0, 250, 500, 750, 1000, 1500] },\n        { id: 'pob-layer', indicatorName: 'Place of Birth', source: 'pob-data-source', property: indicatorConfig['Place of Birth'].property, colors: legendData['Place of Birth'].items.map(i => i.color), stops: [0, 500, 1000, 1500, 2000, 2500] },\n        { id: 'income-layer', indicatorName: 'Income', source: 'income-data-source', property: indicatorConfig.Income.property, colors: legendData.Income.items.map(i => i.color), stops: [0, 500, 1000, 2000, 3000, 3500] },\n        { id: 'occupation-layer', indicatorName: 'Occupation', source: 'occupation-data-source', property: indicatorConfig.Occupation.property, colors: legendData.Occupation.items.map(i => i.color), stops: [0, 250, 500, 750, 1000, 1500, 2000, 2500] }\n      ];\n\n      // --- REVISION START: REORDERED LAYER ADDITION ---\n      // This section is updated to control the layer stacking order precisely as requested:\n      // 1. Precincts (Top)\n      // 2. SA1 (Middle)\n      // 3. Basemap (Bottom)\n\n      // The order in which we call `addLayer` determines the stacking.\n      // Layers added later are drawn on top of layers added earlier.\n      // By not providing a second argument (`beforeId`), each layer is added\n      // to the top of the current style stack.\n\n      // 1. Add the SA1 'fill' layers first. They will be at the bottom of our custom layers.\n      layers.forEach(layer => {\n        const colorStops = layer.stops.flatMap((stop, i) => [stop, layer.colors[i] || layer.colors[layer.colors.length - 1]]);\n        map.current.addLayer({\n          id: layer.id,\n          type: 'fill',\n          source: layer.source,\n          layout: { visibility: 'none' }, // Start with layers hidden\n          paint: {\n            'fill-color': ['interpolate', ['linear'], ['to-number', ['get', layer.property]], ...colorStops],\n            'fill-opacity': 0.75\n          }\n        });\n\n        // Add click listener for each layer to show a popup\n        map.current.on('click', layer.id, (e) => {\n          const feature = e.features[0];\n          if (feature) {\n            const regionName = feature.properties['SA1_CODE21'];\n            const value = feature.properties[layer.property];\n            const formattedValue = !isNaN(value) ? Number(value).toLocaleString() : 'N/A';\n            \n            new maplibregl.Popup()\n              .setLngLat(e.lngLat)\n              .setHTML(`\n                <div style=\"font-family: sans-serif; padding: 5px; text-align: left;\">\n                  <h4 style=\"margin: 0 0 5px 0; font-weight: bold;\">SA1: ${regionName}</h4>\n                  <strong>${layer.indicatorName}:</strong> ${formattedValue}\n                </div>\n              `)\n              .addTo(map.current);\n          }\n        });\n        \n        // Change cursor to pointer on hover\n        map.current.on('mouseenter', layer.id, () => {\n          map.current.getCanvas().style.cursor = 'pointer';\n        });\n        map.current.on('mouseleave', layer.id, () => {\n          map.current.getCanvas().style.cursor = '';\n        });\n      });\n\n      // 2. Add the SA1 outline layer. This is added on top of the SA1 fills.\n      // Together, these two form the \"SA1 Layer\".\n      map.current.addLayer({\n        id: 'base-outline-layer',\n        type: 'line',\n        source: 'base-outline-data-source',\n        paint: {\n          'line-color': '#444', \n          'line-width': 1\n        }\n      });\n      \n      // 3. Add the precincts outline layer LAST. This is added on top of the SA1 layer,\n      // making it the topmost layer on the map.\n      map.current.addLayer({\n          id: 'precincts-outline-layer',\n          type: 'line',\n          source: 'precincts-data-source',\n          paint: {\n              'line-color': '#0868ac', // A distinct blue\n              'line-width': 2.5,\n              'line-opacity': 0.9\n          }\n      });\n      // --- REVISION END ---\n    });\n\n    return () => {\n      if (map.current) {\n        map.current.remove();\n        map.current = null;\n      }\n    };\n  }, []);\n\n  // --- useEffect to Toggle Layer Visibility ---\n  useEffect(() => {\n    if (!map.current || !map.current.isStyleLoaded()) return;\n\n    const allLayerIds = ['employment-layer', 'education-layer', 'pob-layer', 'income-layer', 'occupation-layer'];\n    const selectedLayerId = selectedIndicator ? `${selectedIndicator.toLowerCase().replace(/ /g, '-')}-layer` : null;\n    \n    // The base SA1 outline should be visible whenever any indicator is selected\n    if (map.current.getLayer('base-outline-layer')) {\n        map.current.setLayoutProperty('base-outline-layer', 'visibility', selectedIndicator ? 'visible' : 'none');\n    }\n\n    allLayerIds.forEach(layerId => {\n      if (map.current.getLayer(layerId)) {\n        map.current.setLayoutProperty(layerId, 'visibility', layerId === selectedLayerId ? 'visible' : 'none');\n      }\n    });\n  }, [selectedIndicator]);\n  \n  // --- [REVISED] useEffect to generate description with the Gemini LLM ---\n  useEffect(() => {\n    if (!selectedIndicator) {\n      setDynamicDescription('');\n      return;\n    }\n\n    const generateLLMDescription = async () => {\n      setIsDescriptionLoading(true);\n      setDynamicDescription('');\n\n      const config = indicatorConfig[selectedIndicator];\n      if (!config) {\n        setIsDescriptionLoading(false);\n        return;\n      }\n\n      try {\n        // Step 1: Fetch and analyze the data to get key statistics\n        const response = await fetch(config.path);\n        const geojsonData = await response.json();\n\n        let minFeature = null;\n        let maxFeature = null;\n        let sum = 0;\n        let count = 0;\n\n        geojsonData.features.forEach(feature => {\n          const value = Number(feature.properties[config.property]);\n          if (!isNaN(value)) {\n            if (minFeature === null || value < Number(minFeature.properties[config.property])) {\n              minFeature = feature;\n            }\n            if (maxFeature === null || value > Number(maxFeature.properties[config.property])) {\n              maxFeature = feature;\n            }\n            sum += value;\n            count++;\n          }\n        });\n        \n        if (count === 0) {\n            setDynamicDescription('No valid data found to generate a description.');\n            setIsDescriptionLoading(false);\n            return;\n        }\n\n        const average = (sum / count).toFixed(2);\n        const minValue = Number(minFeature.properties[config.property]);\n        const maxValue = Number(maxFeature.properties[config.property]);\n        const minRegion = minFeature.properties['SA1_CODE21'];\n        const maxRegion = maxFeature.properties['SA1_CODE21'];\n\n        // Step 2: Create a prompt for the LLM\n        const prompt = `\n          You are a concise data analyst for a public-facing dashboard.\n          Based on the following data for the \"${selectedIndicator}\" indicator in Melbourne's inner suburbs, write a short, engaging summary (around 50-70 words).\n          Do not just list the numbers; provide a brief insight into what the data shows (e.g., \"a significant disparity,\" \"a wide range,\" \"a concentration of...\").\n          \n          Key Statistics:\n          - Highest value: ${maxValue.toLocaleString()} (in SA1 area ${maxRegion})\n          - Lowest value: ${minValue.toLocaleString()} (in SA1 area ${minRegion})\n          - Average value across all areas: ${Number(average).toLocaleString()}\n        `;\n\n        // Step 3: Call the Gemini API\n        const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash-latest\" });\n        const result = await model.generateContent(prompt);\n        const llmResponse = await result.response;\n        const text = llmResponse.text();\n        \n        setDynamicDescription(text);\n\n      } catch (error) {\n        console.error(\"Error generating LLM description:\", error);\n        setDynamicDescription('An error occurred while generating the description. Please check your API key and network connection.');\n      } finally {\n        setIsDescriptionLoading(false);\n      }\n    };\n\n    generateLLMDescription();\n  }, [selectedIndicator]); // Re-run when selectedIndicator changes\n\n\n  // --- UI Handlers ---\n  const handleSearchClick = () => {\n    setIndicators(['Employment', 'Education', 'Place of Birth', 'Income', 'Occupation']);\n    setShowIndicators(true);\n  };\n\n  const handleIndicatorSelect = (indicator) => {\n    setSelectedIndicator(prev => (prev === indicator ? null : indicator));\n  };\n\n  // --- Component Render ---\n  return (\n    <div style={{ display: 'flex', width: '100%', height: 'calc(100vh - 78px)' }}>\n      {/* Map container on the left */}\n      <div style={{ position: 'relative', flex: 1 }}>\n        <div ref={mapContainer} style={{ position: 'absolute', width: '100%', height: '100%' }} />\n\n        {/* Search Panel */}\n        <div style={{ position: 'absolute', top: '1rem', left: '1rem', backgroundColor: 'white', padding: '1rem', borderRadius: '0.5rem', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', width: '288px', zIndex: 10 }}>\n          <h3 style={{ fontSize: '1.125rem', fontWeight: 'bold', marginBottom: '1rem' }}>I'm interested in ...</h3>\n          \n          <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>\n            <input\n              type=\"text\"\n              value={searchText}\n              onChange={(e) => setSearchText(e.target.value)}\n              placeholder=\"e.g., 'jobs' or 'housing'\"\n              style={{ padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '0.375rem', outline: 'none' }}\n            />\n            <button\n              onClick={handleSearchClick}\n              style={{ backgroundColor: '#2563EB', color: 'white', fontWeight: 600, padding: '0.5rem 1rem', borderRadius: '0.375rem', border: 'none', cursor: 'pointer' }}\n            >\n              Search\n            </button>\n          </div>\n\n          {showIndicators && (\n            <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #E5E7EB' }}>\n              <h4 style={{ fontWeight: 600, color: '#1F2937', marginBottom: '0.5rem' }}>Suggested Indicators</h4>\n              <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>\n                {indicators.map((indicator) => (\n                  <div key={indicator} style={{ display: 'flex', alignItems: 'center' }}>\n                    <input\n                      type=\"radio\"\n                      id={indicator}\n                      name=\"indicator\"\n                      checked={selectedIndicator === indicator}\n                      onChange={() => handleIndicatorSelect(indicator)}\n                      style={{ height: '1rem', width: '1rem' }}\n                    />\n                    <label htmlFor={indicator} style={{ marginLeft: '0.75rem', fontSize: '0.875rem', color: '#374151' }}>\n                      {indicator}\n                    </label>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n        \n        {/* Conditionally render the Legend */}\n        {selectedIndicator && legendData[selectedIndicator] && (\n          <Legend title={legendData[selectedIndicator].title} items={legendData[selectedIndicator].items} />\n        )}\n      </div>\n\n      {/* Text Explorer Panel on the right */}\n      <div style={{ width: '320px', backgroundColor: '#f8f9fa', padding: '1.5rem', borderLeft: '1px solid #dee2e6', overflowY: 'auto' }}>\n        {selectedIndicator ? (\n          <div>\n            <h4 style={{ fontSize: '1.1rem', fontWeight: 600, color: '#495057', marginBottom: '0.75rem' }}>\n              {selectedIndicator}\n            </h4>\n            {isDescriptionLoading ? (\n              <p style={{ fontSize: '0.95rem', color: '#6c757d', fontStyle: 'italic' }}>\n                ðŸ¤– Generating AI description...\n              </p>\n            ) : (\n              <p style={{ fontSize: '0.95rem', color: '#6c757d', lineHeight: 1.6 }}>\n                {dynamicDescription}\n              </p>\n            )}\n          </div>\n        ) : (\n          <p style={{ fontSize: '0.95rem', color: '#6c757d', fontStyle: 'italic' }}>\n            Select an indicator from the panel on the left to see its description.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}