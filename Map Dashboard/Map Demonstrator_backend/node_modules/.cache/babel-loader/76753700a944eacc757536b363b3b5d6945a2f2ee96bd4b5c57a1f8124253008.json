{"ast":null,"code":"var _jsxFileName = \"/Users/E113938/Library/CloudStorage/OneDrive-RMITUniversity/My Mac Folders/2025/FILTER Project/FILTER/Map Dashboard/Map Demonstrator_backend/src/components/map.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\n\n// (Legend and AI description components removed per requirements)\n\n// --- START: MAP COMPONENT ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Map() {\n  _s();\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const hoverStateBySource = useRef({}); // track hovered feature ids per source for outlines\n  const uploadedLayerEventsBound = useRef(false);\n  const selectedColumnRef = useRef('');\n\n  // Definitions for interactive text highlighting\n  const PRECINCT_NAMES = ['Montague', 'Sandridge', 'Lorimer', 'Wirraway', 'Employment Precinct'];\n  const PRECINCT_COLORS = {\n    'Montague': '#3498db',\n    'Sandridge': '#e74c3c',\n    'Lorimer': '#2ecc71',\n    'Wirraway': '#f39c12',\n    'Employment Precinct': '#9b59b6'\n  };\n\n  // --- STATE MANAGEMENT ---\n  const [selectedIndicator, setSelectedIndicator] = useState(null);\n  const [uploading, setUploading] = useState(false);\n  const [uploadedGeojson, setUploadedGeojson] = useState(null);\n  const [availableColumns, setAvailableColumns] = useState([]);\n  const [columnTypes, setColumnTypes] = useState({}); // { colName: 'number' | 'string' }\n  const [selectedColumn, setSelectedColumn] = useState('');\n  const [legendInfo, setLegendInfo] = useState(null); // { type: 'numeric'|'categorical', items: [{color,label}], title }\n\n  // Panel widths for map padding\n  const leftPanelWidth = 200;\n  const rightPanelWidth = 0;\n\n  // --- DATA DEFINITIONS ---\n  const legendData = {\n    'Education': {\n      title: 'Education (Total)',\n      items: [{\n        color: '#fee5d9',\n        label: 'low'\n      }, {\n        color: '#fcbba1',\n        label: ''\n      }, {\n        color: '#fc9272',\n        label: ''\n      }, {\n        color: '#fb6a4a',\n        label: ''\n      }, {\n        color: '#ef3b2c',\n        label: ''\n      }, {\n        color: '#cb181d',\n        label: 'high'\n      }]\n    },\n    'Income': {\n      title: 'Income (Total)',\n      items: [{\n        color: '#fcfbfd',\n        label: 'low'\n      }, {\n        color: '#efedf5',\n        label: ''\n      }, {\n        color: '#dadaeb',\n        label: ''\n      }, {\n        color: '#bcbddc',\n        label: ''\n      }, {\n        color: '#9e9ac8',\n        label: ''\n      }, {\n        color: '#807dba',\n        label: ''\n      }, {\n        color: '#6a51a3',\n        label: ''\n      }, {\n        color: '#54278f',\n        label: ''\n      }, {\n        color: '#3f007d',\n        label: 'high'\n      }]\n    },\n    'Occupation': {\n      title: 'Occupation (Total)',\n      items: [{\n        color: '#f7fbff',\n        label: 'low'\n      }, {\n        color: '#deebf7',\n        label: ''\n      }, {\n        color: '#c6dbef',\n        label: ''\n      }, {\n        color: '#9ecae1',\n        label: ''\n      }, {\n        color: '#6baed6',\n        label: ''\n      }, {\n        color: '#4292c6',\n        label: ''\n      }, {\n        color: '#2171b5',\n        label: ''\n      }, {\n        color: '#08519c',\n        label: ''\n      }, {\n        color: '#08306b',\n        label: 'high'\n      }]\n    },\n    'Employment': {\n      title: 'Employment (Total)',\n      items: [{\n        color: '#f1eef6',\n        label: 'low'\n      }, {\n        color: '#d7b5d8',\n        label: ''\n      }, {\n        color: '#c994c7',\n        label: ''\n      }, {\n        color: '#df65b0',\n        label: ''\n      }, {\n        color: '#dd1c77',\n        label: 'high'\n      }]\n    },\n    'POB': {\n      title: 'Place of Birth (Total)',\n      items: [{\n        color: '#edf8e9',\n        label: 'low'\n      }, {\n        color: '#bae4b3',\n        label: ''\n      }, {\n        color: '#74c476',\n        label: ''\n      }, {\n        color: '#31a354',\n        label: ''\n      }, {\n        color: '#006d2c',\n        label: 'high'\n      }]\n    }\n  };\n  const indicatorConfig = {\n    'Education': {\n      path: '/data/education-fb-sa1.geojson',\n      property: 'Education-VIC_Total',\n      source: 'education-data-source'\n    },\n    'Employment': {\n      path: '/data/employment-fb-sa1.geojson',\n      property: 'employment-VIC_Total',\n      source: 'employment-data-source'\n    },\n    'Income': {\n      path: '/data/income-fb-sa1.geojson',\n      property: 'Income-VIC1_Total',\n      source: 'income-data-source'\n    },\n    'POB': {\n      path: '/data/POB-fb-sa1.geojson',\n      property: 'POB-VIC1_Total',\n      source: 'pob-data-source'\n    },\n    'Occupation': {\n      path: '/data/occupation-fb-sa1.geojson',\n      property: 'Occupation-VIC_Total',\n      source: 'occupation-data-source'\n    }\n  };\n\n  // --- HOOKS for Map Lifecycle & Effects ---\n\n  // Main Map Initialization\n  useEffect(() => {\n    if (map.current) return;\n    if (!mapContainer.current) return;\n    map.current = new maplibregl.Map({\n      container: mapContainer.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      scrollZoom: false,\n      boxZoom: false,\n      dragRotate: false,\n      dragPan: false,\n      keyboard: false,\n      doubleClickZoom: false,\n      touchZoomRotate: false,\n      preserveDrawingBuffer: true // Required for exporting map canvas\n    });\n    map.current.on('error', e => console.error('A map error occurred:', e.error ? e.error.message : 'Unknown error'));\n    map.current.on('load', () => {\n      adjustMapBounds();\n      // Add sources\n      const sources = [{\n        name: 'base-outline',\n        path: '/data/fb-sa1-2021-WGS84-boundary.geojson'\n      }, {\n        name: 'employment',\n        path: '/data/employment-fb-sa1.geojson',\n        promoteId: 'SA1_CODE21'\n      }, {\n        name: 'education',\n        path: '/data/education-fb-sa1.geojson',\n        promoteId: 'SA1_CODE21'\n      }, {\n        name: 'pob',\n        path: '/data/POB-fb-sa1.geojson',\n        promoteId: 'SA1_CODE21'\n      }, {\n        name: 'income',\n        path: '/data/income-fb-sa1.geojson',\n        promoteId: 'SA1_CODE21'\n      }, {\n        name: 'occupation',\n        path: '/data/occupation-fb-sa1.geojson',\n        promoteId: 'SA1_CODE21'\n      }, {\n        name: 'precincts',\n        path: '/data/fb-precincts-official-boundary.geojson'\n      }\n      // jobs layers removed per requirements\n      ];\n      sources.forEach(s => {\n        const spec = {\n          type: 'geojson',\n          data: s.path\n        };\n        if (s.promoteId) spec.promoteId = s.promoteId;\n        map.current.addSource(`${s.name}-data-source`, spec);\n      });\n\n      // Define layers for indicators\n      const layers = [{\n        id: 'education-layer',\n        indicatorName: 'Education',\n        source: 'education-data-source',\n        property: indicatorConfig['Education'].property,\n        colors: legendData['Education'].items.map(i => i.color),\n        stops: [0, 100, 200, 300, 400, 500]\n      }, {\n        id: 'employment-layer',\n        indicatorName: 'Employment',\n        source: 'employment-data-source',\n        property: indicatorConfig['Employment'].property,\n        colors: legendData['Employment'].items.map(i => i.color),\n        stops: [0, 100, 200, 300, 400]\n      }, {\n        id: 'income-layer',\n        indicatorName: 'Income',\n        source: 'income-data-source',\n        property: indicatorConfig['Income'].property,\n        colors: legendData['Income'].items.map(i => i.color),\n        stops: [0, 100, 200, 300, 400, 500, 600, 700, 800]\n      }, {\n        id: 'pob-layer',\n        indicatorName: 'POB',\n        source: 'pob-data-source',\n        property: indicatorConfig['POB'].property,\n        colors: legendData['POB'].items.map(i => i.color),\n        stops: [0, 100, 200, 300, 400]\n      }, {\n        id: 'occupation-layer',\n        indicatorName: 'Occupation',\n        source: 'occupation-data-source',\n        property: indicatorConfig['Occupation'].property,\n        colors: legendData['Occupation'].items.map(i => i.color),\n        stops: [0, 100, 200, 300, 400, 500, 600, 700, 800]\n      }];\n      layers.forEach(layer => {\n        // Fill paint\n        let paint;\n        if (layer.type === 'step') {\n          const base = '#ffffff';\n          const stepExpr = ['step', ['to-number', ['get', layer.property]], base];\n          layer.breaks.forEach((b, i) => {\n            stepExpr.push(b, layer.colors[i] || layer.colors[layer.colors.length - 1]);\n          });\n          paint = {\n            'fill-color': stepExpr,\n            'fill-opacity': 0.6\n          };\n        } else {\n          const colorStops = layer.stops.flatMap((stop, i) => [stop, layer.colors[i] || layer.colors[layer.colors.length - 1]]);\n          paint = {\n            'fill-color': ['interpolate', ['linear'], ['to-number', ['get', layer.property]], ...colorStops],\n            'fill-opacity': 0.6\n          };\n        }\n        map.current.addLayer({\n          id: layer.id,\n          type: 'fill',\n          source: layer.source,\n          layout: {\n            visibility: 'none'\n          },\n          paint\n        });\n\n        // Base thin boundary for clear geometry edges (always visible with layer)\n        const baseOutlineId = `${layer.id}-base-outline`;\n        map.current.addLayer({\n          id: baseOutlineId,\n          type: 'line',\n          source: layer.source,\n          layout: {\n            visibility: 'none'\n          },\n          paint: {\n            'line-color': '#666',\n            'line-width': 0.4,\n            'line-opacity': 0.7\n          }\n        });\n\n        // Outline layer that lights up on hover\n        const outlineId = `${layer.id}-hover-outline`;\n        map.current.addLayer({\n          id: outlineId,\n          type: 'line',\n          source: layer.source,\n          layout: {\n            visibility: 'none'\n          },\n          paint: {\n            'line-color': '#111',\n            'line-width': 2.5,\n            'line-opacity': ['case', ['boolean', ['feature-state', 'hover'], false], 1, 0]\n          }\n        });\n\n        // Hover feature-state handlers\n        map.current.on('mousemove', layer.id, e => {\n          if (!e.features || !e.features.length) return;\n          const f = e.features[0];\n          const sourceId = layer.source;\n          const prev = hoverStateBySource.current[sourceId];\n          if (prev !== undefined) {\n            try {\n              map.current.setFeatureState({\n                source: sourceId,\n                id: prev\n              }, {\n                hover: false\n              });\n            } catch (_) {}\n          }\n          hoverStateBySource.current[sourceId] = f.id;\n          try {\n            map.current.setFeatureState({\n              source: sourceId,\n              id: f.id\n            }, {\n              hover: true\n            });\n          } catch (_) {}\n        });\n        map.current.on('mouseleave', layer.id, () => {\n          const sourceId = layer.source;\n          const prev = hoverStateBySource.current[sourceId];\n          if (prev !== undefined) {\n            try {\n              map.current.setFeatureState({\n                source: sourceId,\n                id: prev\n              }, {\n                hover: false\n              });\n            } catch (_) {}\n            hoverStateBySource.current[sourceId] = undefined;\n          }\n        });\n      });\n      map.current.addLayer({\n        id: 'base-outline-layer',\n        type: 'line',\n        source: 'base-outline-data-source',\n        paint: {\n          'line-color': '#444',\n          'line-width': 0.2\n        }\n      });\n      const precinctColorExpression = ['case'];\n      PRECINCT_NAMES.forEach(name => {\n        precinctColorExpression.push(['==', ['get', 'name'], name], PRECINCT_COLORS[name]);\n      });\n      precinctColorExpression.push('#CCC');\n      map.current.addLayer({\n        id: 'precincts-fill-layer',\n        type: 'fill',\n        source: 'precincts-data-source',\n        paint: {\n          'fill-color': '#ffffffff',\n          'fill-opacity': 0.15\n        }\n      });\n      map.current.addLayer({\n        id: 'precincts-shadow-layer',\n        type: 'line',\n        source: 'precincts-data-source',\n        paint: {\n          'line-color': 'rgba(0, 0, 0, 0.4)',\n          'line-width': 7,\n          'line-translate': [2, 2],\n          'line-blur': 4\n        }\n      });\n      map.current.addLayer({\n        id: 'precincts-outline-layer',\n        type: 'line',\n        source: 'precincts-data-source',\n        paint: {\n          'line-color': '#0868ac',\n          'line-width': 2.5,\n          'line-opacity': 0.9\n        }\n      });\n\n      // Precinct click handlers removed (no narrative panel)\n\n      map.current.on('mouseenter', 'precincts-fill-layer', () => {\n        map.current.getCanvas().style.cursor = 'pointer';\n      });\n      map.current.on('mouseleave', 'precincts-fill-layer', () => {\n        map.current.getCanvas().style.cursor = '';\n      });\n    });\n    return () => {\n      if (map.current) {\n        map.current.remove();\n        map.current = null;\n      }\n    };\n  }, []);\n\n  // Adjust map bounds on load\n  const adjustMapBounds = () => {\n    if (!map.current) return;\n    const bounds = [[144.890, -37.850], [144.948, -37.816]];\n    map.current.fitBounds(bounds, {\n      padding: {\n        top: 20,\n        bottom: 20,\n        left: leftPanelWidth,\n        right: rightPanelWidth\n      },\n      duration: 2000,\n      essential: true\n    });\n  };\n\n  // Adjust map bounds on window resize\n  useEffect(() => {\n    function debounce(fn, ms) {\n      let timer;\n      return function (...args) {\n        clearTimeout(timer);\n        timer = setTimeout(() => {\n          fn.apply(this, args);\n        }, ms);\n      };\n    }\n    const debouncedAdjustBounds = () => {\n      if (!map.current) return;\n      const bounds = [[144.890, -37.850], [144.948, -37.816]];\n      map.current.fitBounds(bounds, {\n        padding: {\n          top: 20,\n          bottom: 20,\n          left: leftPanelWidth,\n          right: rightPanelWidth\n        },\n        duration: 0\n      });\n    };\n    const debouncedResizeListener = debounce(debouncedAdjustBounds, 150);\n    window.addEventListener('resize', debouncedResizeListener);\n    return () => window.removeEventListener('resize', debouncedResizeListener);\n  }, []);\n\n  // Toggle visibility of indicator layers\n  useEffect(() => {\n    if (!map.current || !map.current.isStyleLoaded()) return;\n    const allLayerIds = ['education-layer', 'employment-layer', 'income-layer', 'pob-layer', 'occupation-layer'];\n    // Do NOT show preloaded indicator layers when selecting an indicator; we only visualize uploaded CSV output\n    const selectedLayerId = null;\n    if (map.current.getLayer('base-outline-layer')) {\n      map.current.setLayoutProperty('base-outline-layer', 'visibility', selectedIndicator ? 'visible' : 'none');\n    }\n    allLayerIds.forEach(layerId => {\n      if (map.current.getLayer(layerId)) {\n        const vis = layerId === selectedLayerId ? 'visible' : 'none';\n        map.current.setLayoutProperty(layerId, 'visibility', vis);\n        const outlineId = `${layerId}-hover-outline`;\n        const baseOutlineId = `${layerId}-base-outline`;\n        if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', vis);\n        if (map.current.getLayer(baseOutlineId)) map.current.setLayoutProperty(baseOutlineId, 'visibility', vis);\n      }\n    });\n  }, [selectedIndicator]);\n\n  // Keep a ref of the latest selected column for event handlers\n  useEffect(() => {\n    selectedColumnRef.current = selectedColumn || '';\n  }, [selectedColumn]);\n\n  // Handle uploaded GeoJSON rendering (depends on selectedColumn)\n  useEffect(() => {\n    var _legendData$selectedI;\n    if (!map.current || !map.current.isStyleLoaded()) return;\n    const sourceId = 'uploaded-geojson-source';\n    const fillId = 'uploaded-geojson-fill';\n    const outlineId = 'uploaded-geojson-outline';\n    if (!uploadedGeojson || !selectedColumn) {\n      if (map.current.getLayer(fillId)) map.current.setLayoutProperty(fillId, 'visibility', 'none');\n      if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', 'none');\n      setLegendInfo(null);\n      return;\n    }\n    const isNumeric = val => {\n      const n = Number(val);\n      return Number.isFinite(n);\n    };\n    const type = columnTypes[selectedColumn] || 'number';\n    const palette = (((_legendData$selectedI = legendData[selectedIndicator]) === null || _legendData$selectedI === void 0 ? void 0 : _legendData$selectedI.items) || [{\n      color: '#fee5d9'\n    }, {\n      color: '#fcae91'\n    }, {\n      color: '#fb6a4a'\n    }, {\n      color: '#de2d26'\n    }, {\n      color: '#a50f15'\n    }]).map(i => i.color);\n    let fillPaint;\n    let legend;\n    const fmt = new Intl.NumberFormat('en-AU', {\n      maximumFractionDigits: 2\n    });\n    if (type === 'number') {\n      // Collect numeric values\n      const values = (uploadedGeojson.features || []).map(f => Number((f.properties || {})[selectedColumn])).filter(v => Number.isFinite(v)).sort((a, b) => a - b);\n      let min = values.length ? values[0] : 0;\n      let max = values.length ? values[values.length - 1] : 1;\n      if (!Number.isFinite(min)) min = 0;\n      if (!Number.isFinite(max)) max = 1;\n\n      // Equal intervals into 5 classes\n      let step = (max - min) / 5;\n      if (!Number.isFinite(step) || step === 0) step = 1; // fallback for constant data\n      const breaks = [min + step, min + 2 * step, min + 3 * step, min + 4 * step];\n\n      // Prepare a 5-color palette\n      const baseColors = palette.length >= 5 ? palette.slice(0, 5) : ['#fee5d9', '#fcae91', '#fb6a4a', '#de2d26', '#a50f15'];\n\n      // Step expression with 5 classes\n      const inputExpr = ['to-number', ['get', selectedColumn]];\n      const stepExpr = ['step', inputExpr, baseColors[0], breaks[0], baseColors[1], breaks[1], baseColors[2], breaks[2], baseColors[3], breaks[3], baseColors[4]];\n      fillPaint = {\n        'fill-color': stepExpr,\n        'fill-opacity': 0.6\n      };\n\n      // Legend items with ranges: [min,b1), [b1,b2), [b2,b3), [b3,b4), [b4,max]\n      const ranges = [{\n        from: min,\n        to: breaks[0],\n        color: baseColors[0]\n      }, {\n        from: breaks[0],\n        to: breaks[1],\n        color: baseColors[1]\n      }, {\n        from: breaks[1],\n        to: breaks[2],\n        color: baseColors[2]\n      }, {\n        from: breaks[2],\n        to: breaks[3],\n        color: baseColors[3]\n      }, {\n        from: breaks[3],\n        to: max,\n        color: baseColors[4]\n      }];\n      const items = ranges.map(r => ({\n        color: r.color,\n        label: `${fmt.format(r.from)} – ${fmt.format(r.to)}`\n      }));\n      legend = {\n        type: 'numeric',\n        title: selectedColumn,\n        items\n      };\n    } else {\n      // Categorical palette\n      const catColors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd', '#8c564b', '#e377c2', '#7f7f7f', '#bcbd22', '#17becf', '#aec7e8', '#ffbb78'];\n      const uniques = Array.from(new Set((uploadedGeojson.features || []).map(f => (f.properties || {})[selectedColumn]).filter(v => v !== undefined && v !== null)));\n      const maxCats = 12;\n      const cats = uniques.slice(0, maxCats);\n      const matchExpr = ['match', ['get', selectedColumn]];\n      cats.forEach((c, i) => {\n        matchExpr.push(c, catColors[i % catColors.length]);\n      });\n      matchExpr.push('#cccccc'); // default color for others\n      fillPaint = {\n        'fill-color': matchExpr,\n        'fill-opacity': 0.6\n      };\n      legend = {\n        type: 'categorical',\n        title: selectedColumn,\n        items: cats.map((c, i) => ({\n          color: catColors[i % catColors.length],\n          label: String(c)\n        }))\n      };\n    }\n    if (map.current.getSource(sourceId)) {\n      map.current.getSource(sourceId).setData(uploadedGeojson);\n    } else {\n      map.current.addSource(sourceId, {\n        type: 'geojson',\n        data: uploadedGeojson\n      });\n      map.current.addLayer({\n        id: fillId,\n        type: 'fill',\n        source: sourceId,\n        paint: fillPaint\n      });\n      map.current.addLayer({\n        id: outlineId,\n        type: 'line',\n        source: sourceId,\n        paint: {\n          'line-color': '#cc8800',\n          'line-width': 1.2\n        }\n      });\n    }\n    // Update paint if layer already exists (e.g., new upload with a different key/range)\n    if (map.current.getLayer(fillId)) {\n      map.current.setPaintProperty(fillId, 'fill-color', fillPaint['fill-color']);\n      map.current.setPaintProperty(fillId, 'fill-opacity', fillPaint['fill-opacity']);\n    }\n    if (map.current.getLayer(fillId)) map.current.setLayoutProperty(fillId, 'visibility', 'visible');\n    if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', 'visible');\n\n    // Bind interactive events once\n    if (!uploadedLayerEventsBound.current && map.current.getLayer(fillId)) {\n      const onEnter = () => {\n        try {\n          map.current.getCanvas().style.cursor = 'pointer';\n        } catch (_) {}\n      };\n      const onLeave = () => {\n        try {\n          map.current.getCanvas().style.cursor = '';\n        } catch (_) {}\n      };\n      const onClick = e => {\n        if (!e.features || !e.features.length) return;\n        const f = e.features[0];\n        const col = selectedColumnRef.current;\n        const val = f.properties && col in f.properties ? f.properties[col] : undefined;\n        const sa1 = f.properties && (f.properties.SA1_CODE || f.properties.SA1_CODE21) || '';\n        const html = `\n          <div style=\"font-weight:600;margin-bottom:4px;\">${col}</div>\n          <div>${val !== undefined && val !== null && `${val}`.trim() !== '' ? String(val) : 'N/A'}</div>\n          ${sa1 ? `<div style=\"margin-top:6px;color:#666;\">SA1: ${sa1}</div>` : ''}\n        `;\n        new maplibregl.Popup({\n          closeButton: true\n        }).setLngLat(e.lngLat).setHTML(html).addTo(map.current);\n      };\n      map.current.on('mouseenter', fillId, onEnter);\n      map.current.on('mouseleave', fillId, onLeave);\n      map.current.on('click', fillId, onClick);\n      uploadedLayerEventsBound.current = true;\n    }\n    setLegendInfo(legend);\n  }, [uploadedGeojson, selectedColumn]);\n  const handleFileChange = async e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file || !selectedIndicator) return;\n    setUploading(true);\n    try {\n      const form = new FormData();\n      form.append('indicator', selectedIndicator.toLowerCase());\n      form.append('file', file);\n      const attempts = [];\n      const base = process.env.REACT_APP_API_URL;\n      if (base) attempts.push(`${base}/generate`);\n      // CRA dev proxy\n      attempts.push('/generate');\n      // Same host on port 8000\n      if (typeof window !== 'undefined') {\n        const proto = window.location.protocol;\n        const host = window.location.hostname;\n        attempts.push(`${proto}//${host}:8000/generate`);\n      }\n      // Explicit localhost\n      attempts.push('http://localhost:8000/generate');\n      let res;\n      let lastErr;\n      for (const url of attempts) {\n        try {\n          res = await fetch(url, {\n            method: 'POST',\n            body: form\n          });\n          if (res.ok) break;\n          lastErr = new Error(`HTTP ${res.status} at ${url}`);\n        } catch (err) {\n          lastErr = err;\n        }\n      }\n      if (!res || !res.ok) throw lastErr || new Error('Upload failed');\n      const geojson = await res.json();\n      setUploadedGeojson(geojson);\n      // Derive columns and types from the first feature\n      const props = geojson.features && geojson.features[0] && geojson.features[0].properties ? geojson.features[0].properties : {};\n      const cols = Object.keys(props).filter(k => k !== 'SA1_CODE');\n      // Infer type per column\n      const inferTypes = {};\n      cols.forEach(col => {\n        const sample = (geojson.features || []).slice(0, 200).map(f => (f.properties || {})[col]).filter(v => v !== undefined && v !== null && `${v}`.trim() !== '');\n        const numericCount = sample.filter(v => Number.isFinite(Number(v))).length;\n        const ratio = sample.length ? numericCount / sample.length : 0;\n        inferTypes[col] = ratio >= 0.6 ? 'number' : 'string';\n      });\n      setAvailableColumns(cols);\n      setColumnTypes(inferTypes);\n      setSelectedColumn('');\n    } catch (err) {\n      console.error(err);\n      alert('Failed to generate GeoJSON from CSV. See console for details.');\n    } finally {\n      setUploading(false);\n      // Reset file input to allow re-upload of same file\n      e.target.value = '';\n    }\n  };\n\n  // (All narrative, search, and export logic removed)\n\n  // --- RENDER METHOD ---\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%',\n      height: 'calc(100vh - 78px)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainer,\n      style: {\n        position: 'absolute',\n        width: '100%',\n        height: '100%'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '1rem',\n        left: '1rem',\n        backgroundColor: 'white',\n        padding: '1rem',\n        borderRadius: '0.5rem',\n        boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\n        width: '288px',\n        zIndex: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          fontSize: '1.125rem',\n          fontWeight: 600,\n          marginBottom: '0.5rem'\n        },\n        children: \"Select Indicator\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 460,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: selectedIndicator || '',\n        onChange: e => setSelectedIndicator(e.target.value || null),\n        style: {\n          width: '100%',\n          padding: '0.5rem',\n          border: '1px solid #D1D5DB',\n          borderRadius: '0.375rem',\n          marginBottom: '0.75rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Select\\u2026\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 466,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Education\",\n          children: \"Education\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Employment\",\n          children: \"Employment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Income\",\n          children: \"Income\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"POB\",\n          children: \"POB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 470,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Occupation\",\n          children: \"Occupation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'block',\n          fontSize: '0.9rem',\n          marginBottom: '0.5rem'\n        },\n        children: \"Upload CSV for selected indicator\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 3\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \".csv,text/csv\",\n        onChange: handleFileChange,\n        disabled: !selectedIndicator || uploading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 3\n      }, this), uploading && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '0.5rem',\n          fontSize: '0.85rem'\n        },\n        children: \"Processing\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 475,\n        columnNumber: 23\n      }, this), uploadedGeojson && availableColumns.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '0.75rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            fontSize: '0.9rem',\n            marginBottom: '0.5rem'\n          },\n          children: \"Select column to visualize\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          value: selectedColumn,\n          onChange: e => setSelectedColumn(e.target.value),\n          style: {\n            width: '100%',\n            padding: '0.5rem',\n            border: '1px solid #D1D5DB',\n            borderRadius: '0.375rem'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"Choose a column\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 15\n          }, this), availableColumns.map(col => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: col,\n            children: [col, columnTypes[col] === 'number' ? '' : ' (categorical)']\n          }, col, true, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 17\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 7\n    }, this), legendInfo && selectedColumn && uploadedGeojson && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        right: '1rem',\n        bottom: '1rem',\n        backgroundColor: 'white',\n        padding: '0.75rem',\n        borderRadius: '0.5rem',\n        boxShadow: '0 4px 6px rgba(0,0,0,0.1)',\n        width: '240px',\n        zIndex: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          marginBottom: '0.5rem',\n          fontSize: '0.95rem'\n        },\n        children: legendInfo.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 498,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: '20px 1fr',\n          rowGap: '6px',\n          columnGap: '8px'\n        },\n        children: legendInfo.items.map((it, idx) => /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '18px',\n              height: '18px',\n              backgroundColor: it.color,\n              border: '1px solid #ddd',\n              borderRadius: '2px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '0.9rem',\n              color: '#333'\n            },\n            children: it.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 503,\n            columnNumber: 17\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 497,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 456,\n    columnNumber: 5\n  }, this);\n}\n// --- END: MAP COMPONENT ---\n_s(Map, \"R9AOPoRiQaZyCDUoaiH1kvWYFb0=\");\n_c = Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useState","useEffect","useRef","maplibregl","jsxDEV","_jsxDEV","Map","_s","mapContainer","map","hoverStateBySource","uploadedLayerEventsBound","selectedColumnRef","PRECINCT_NAMES","PRECINCT_COLORS","selectedIndicator","setSelectedIndicator","uploading","setUploading","uploadedGeojson","setUploadedGeojson","availableColumns","setAvailableColumns","columnTypes","setColumnTypes","selectedColumn","setSelectedColumn","legendInfo","setLegendInfo","leftPanelWidth","rightPanelWidth","legendData","title","items","color","label","indicatorConfig","path","property","source","current","container","style","scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","preserveDrawingBuffer","on","e","console","error","message","adjustMapBounds","sources","name","promoteId","forEach","s","spec","type","data","addSource","layers","id","indicatorName","colors","i","stops","layer","paint","base","stepExpr","breaks","b","push","length","colorStops","flatMap","stop","addLayer","layout","visibility","baseOutlineId","outlineId","features","f","sourceId","prev","undefined","setFeatureState","hover","_","precinctColorExpression","getCanvas","cursor","remove","bounds","fitBounds","padding","top","bottom","left","right","duration","essential","debounce","fn","ms","timer","args","clearTimeout","setTimeout","apply","debouncedAdjustBounds","debouncedResizeListener","window","addEventListener","removeEventListener","isStyleLoaded","allLayerIds","selectedLayerId","getLayer","setLayoutProperty","layerId","vis","_legendData$selectedI","fillId","isNumeric","val","n","Number","isFinite","palette","fillPaint","legend","fmt","Intl","NumberFormat","maximumFractionDigits","values","properties","filter","v","sort","a","min","max","step","baseColors","slice","inputExpr","ranges","from","to","r","format","catColors","uniques","Array","Set","maxCats","cats","matchExpr","c","String","getSource","setData","setPaintProperty","onEnter","onLeave","onClick","col","sa1","SA1_CODE","SA1_CODE21","html","trim","Popup","closeButton","setLngLat","lngLat","setHTML","addTo","handleFileChange","_e$target$files","file","target","files","form","FormData","append","toLowerCase","attempts","process","env","REACT_APP_API_URL","proto","location","protocol","host","hostname","res","lastErr","url","fetch","method","body","ok","Error","status","err","geojson","json","props","cols","Object","keys","k","inferTypes","sample","numericCount","ratio","alert","value","position","width","height","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","backgroundColor","borderRadius","boxShadow","zIndex","fontSize","fontWeight","marginBottom","onChange","border","display","accept","disabled","marginTop","gridTemplateColumns","rowGap","columnGap","it","idx","Fragment","_c","$RefreshReg$"],"sources":["/Users/E113938/Library/CloudStorage/OneDrive-RMITUniversity/My Mac Folders/2025/FILTER Project/FILTER/Map Dashboard/Map Demonstrator_backend/src/components/map.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport maplibregl from 'maplibre-gl';\nimport 'maplibre-gl/dist/maplibre-gl.css';\n\n// (Legend and AI description components removed per requirements)\n\n\n// --- START: MAP COMPONENT ---\nexport default function Map() {\n  const mapContainer = useRef(null);\n  const map = useRef(null);\n  const hoverStateBySource = useRef({}); // track hovered feature ids per source for outlines\n  const uploadedLayerEventsBound = useRef(false);\n  const selectedColumnRef = useRef('');\n\n  // Definitions for interactive text highlighting\n  const PRECINCT_NAMES = ['Montague', 'Sandridge', 'Lorimer', 'Wirraway', 'Employment Precinct'];\n  const PRECINCT_COLORS = {\n    'Montague': '#3498db',\n    'Sandridge': '#e74c3c',\n    'Lorimer': '#2ecc71',\n    'Wirraway': '#f39c12',\n    'Employment Precinct': '#9b59b6'\n  };\n\n  // --- STATE MANAGEMENT ---\n  const [selectedIndicator, setSelectedIndicator] = useState(null);\n  const [uploading, setUploading] = useState(false);\n  const [uploadedGeojson, setUploadedGeojson] = useState(null);\n  const [availableColumns, setAvailableColumns] = useState([]);\n  const [columnTypes, setColumnTypes] = useState({}); // { colName: 'number' | 'string' }\n  const [selectedColumn, setSelectedColumn] = useState('');\n  const [legendInfo, setLegendInfo] = useState(null); // { type: 'numeric'|'categorical', items: [{color,label}], title }\n\n  // Panel widths for map padding\n  const leftPanelWidth = 200;\n  const rightPanelWidth = 0;\n\n  // --- DATA DEFINITIONS ---\n  const legendData = {\n    'Education': {\n      title: 'Education (Total)',\n      items: [ { color: '#fee5d9', label: 'low' }, { color: '#fcbba1', label: '' }, { color: '#fc9272', label: '' }, { color: '#fb6a4a', label: '' }, { color: '#ef3b2c', label: '' }, { color: '#cb181d', label: 'high' } ]\n    },\n    'Income': {\n      title: 'Income (Total)',\n      items: [ { color: '#fcfbfd', label: 'low' }, { color: '#efedf5', label: '' }, { color: '#dadaeb', label: '' }, { color: '#bcbddc', label: '' }, { color: '#9e9ac8', label: '' }, { color: '#807dba', label: '' }, { color: '#6a51a3', label: '' }, { color: '#54278f', label: '' }, { color: '#3f007d', label: 'high' } ]\n    },\n    'Occupation': {\n      title: 'Occupation (Total)',\n      items: [ { color: '#f7fbff', label: 'low' }, { color: '#deebf7', label: '' }, { color: '#c6dbef', label: '' }, { color: '#9ecae1', label: '' }, { color: '#6baed6', label: '' }, { color: '#4292c6', label: '' }, { color: '#2171b5', label: '' }, { color: '#08519c', label: '' }, { color: '#08306b', label: 'high' } ]\n    },\n    'Employment': {\n      title: 'Employment (Total)',\n      items: [ { color: '#f1eef6', label: 'low' }, { color: '#d7b5d8', label: '' }, { color: '#c994c7', label: '' }, { color: '#df65b0', label: '' }, { color: '#dd1c77', label: 'high' } ]\n    },\n    'POB': {\n      title: 'Place of Birth (Total)',\n      items: [ { color: '#edf8e9', label: 'low' }, { color: '#bae4b3', label: '' }, { color: '#74c476', label: '' }, { color: '#31a354', label: '' }, { color: '#006d2c', label: 'high' } ]\n    }\n  };\n\n  const indicatorConfig = {\n    'Education': { path: '/data/education-fb-sa1.geojson', property: 'Education-VIC_Total', source: 'education-data-source' },\n    'Employment': { path: '/data/employment-fb-sa1.geojson', property: 'employment-VIC_Total', source: 'employment-data-source' },\n    'Income': { path: '/data/income-fb-sa1.geojson', property: 'Income-VIC1_Total', source: 'income-data-source' },\n    'POB': { path: '/data/POB-fb-sa1.geojson', property: 'POB-VIC1_Total', source: 'pob-data-source' },\n    'Occupation': { path: '/data/occupation-fb-sa1.geojson', property: 'Occupation-VIC_Total', source: 'occupation-data-source' }\n  };\n\n  // --- HOOKS for Map Lifecycle & Effects ---\n\n  // Main Map Initialization\n  useEffect(() => {\n    if (map.current) return;\n    if (!mapContainer.current) return;\n\n    map.current = new maplibregl.Map({\n      container: mapContainer.current,\n      style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',\n      scrollZoom: false, boxZoom: false, dragRotate: false, dragPan: false,\n      keyboard: false, doubleClickZoom: false, touchZoomRotate: false,\n      preserveDrawingBuffer: true // Required for exporting map canvas\n    });\n\n    map.current.on('error', (e) => console.error('A map error occurred:', e.error ? e.error.message : 'Unknown error'));\n\n    map.current.on('load', () => {\n      adjustMapBounds();\n      // Add sources\n      const sources = [\n        { name: 'base-outline', path: '/data/fb-sa1-2021-WGS84-boundary.geojson' },\n        { name: 'employment', path: '/data/employment-fb-sa1.geojson', promoteId: 'SA1_CODE21' },\n        { name: 'education', path: '/data/education-fb-sa1.geojson', promoteId: 'SA1_CODE21' },\n        { name: 'pob', path: '/data/POB-fb-sa1.geojson', promoteId: 'SA1_CODE21' },\n        { name: 'income', path: '/data/income-fb-sa1.geojson', promoteId: 'SA1_CODE21' },\n        { name: 'occupation', path: '/data/occupation-fb-sa1.geojson', promoteId: 'SA1_CODE21' },\n        { name: 'precincts', path: '/data/fb-precincts-official-boundary.geojson' },\n        // jobs layers removed per requirements\n      ];\n      sources.forEach(s => {\n        const spec = { type: 'geojson', data: s.path };\n        if (s.promoteId) spec.promoteId = s.promoteId;\n        map.current.addSource(`${s.name}-data-source`, spec);\n      });\n\n      // Define layers for indicators\n      const layers = [\n        { id: 'education-layer', indicatorName: 'Education', source: 'education-data-source', property: indicatorConfig['Education'].property, colors: legendData['Education'].items.map(i => i.color), stops: [0, 100, 200, 300, 400, 500] },\n        { id: 'employment-layer', indicatorName: 'Employment', source: 'employment-data-source', property: indicatorConfig['Employment'].property, colors: legendData['Employment'].items.map(i => i.color), stops: [0, 100, 200, 300, 400] },\n        { id: 'income-layer', indicatorName: 'Income', source: 'income-data-source', property: indicatorConfig['Income'].property, colors: legendData['Income'].items.map(i => i.color), stops: [0, 100, 200, 300, 400, 500, 600, 700, 800] },\n        { id: 'pob-layer', indicatorName: 'POB', source: 'pob-data-source', property: indicatorConfig['POB'].property, colors: legendData['POB'].items.map(i => i.color), stops: [0, 100, 200, 300, 400] },\n        { id: 'occupation-layer', indicatorName: 'Occupation', source: 'occupation-data-source', property: indicatorConfig['Occupation'].property, colors: legendData['Occupation'].items.map(i => i.color), stops: [0, 100, 200, 300, 400, 500, 600, 700, 800] }\n      ];\n\n      layers.forEach(layer => {\n        // Fill paint\n        let paint;\n        if (layer.type === 'step') {\n          const base = '#ffffff';\n          const stepExpr = ['step', ['to-number', ['get', layer.property]], base];\n          layer.breaks.forEach((b, i) => { stepExpr.push(b, layer.colors[i] || layer.colors[layer.colors.length - 1]); });\n          paint = { 'fill-color': stepExpr, 'fill-opacity': 0.6 };\n        } else {\n          const colorStops = layer.stops.flatMap((stop, i) => [stop, layer.colors[i] || layer.colors[layer.colors.length - 1]]);\n          paint = { 'fill-color': ['interpolate', ['linear'], ['to-number', ['get', layer.property]], ...colorStops], 'fill-opacity': 0.6 };\n        }\n        map.current.addLayer({ id: layer.id, type: 'fill', source: layer.source, layout: { visibility: 'none' }, paint });\n\n        // Base thin boundary for clear geometry edges (always visible with layer)\n        const baseOutlineId = `${layer.id}-base-outline`;\n        map.current.addLayer({\n          id: baseOutlineId,\n          type: 'line',\n          source: layer.source,\n          layout: { visibility: 'none' },\n          paint: { 'line-color': '#666', 'line-width': 0.4, 'line-opacity': 0.7 }\n        });\n\n  // Outline layer that lights up on hover\n  const outlineId = `${layer.id}-hover-outline`;\n        map.current.addLayer({\n          id: outlineId,\n          type: 'line',\n          source: layer.source,\n          layout: { visibility: 'none' },\n          paint: {\n            'line-color': '#111',\n            'line-width': 2.5,\n            'line-opacity': ['case', ['boolean', ['feature-state', 'hover'], false], 1, 0]\n          }\n        });\n\n        // Hover feature-state handlers\n        map.current.on('mousemove', layer.id, (e) => {\n          if (!e.features || !e.features.length) return;\n          const f = e.features[0];\n          const sourceId = layer.source;\n          const prev = hoverStateBySource.current[sourceId];\n          if (prev !== undefined) {\n            try { map.current.setFeatureState({ source: sourceId, id: prev }, { hover: false }); } catch (_) {}\n          }\n          hoverStateBySource.current[sourceId] = f.id;\n          try { map.current.setFeatureState({ source: sourceId, id: f.id }, { hover: true }); } catch (_) {}\n        });\n        map.current.on('mouseleave', layer.id, () => {\n          const sourceId = layer.source;\n          const prev = hoverStateBySource.current[sourceId];\n          if (prev !== undefined) {\n            try { map.current.setFeatureState({ source: sourceId, id: prev }, { hover: false }); } catch (_) {}\n            hoverStateBySource.current[sourceId] = undefined;\n          }\n        });\n      });\n\n      map.current.addLayer({\n        id: 'base-outline-layer', type: 'line', source: 'base-outline-data-source',\n        paint: { 'line-color': '#444', 'line-width': 0.2 }\n      });\n      \n      const precinctColorExpression = ['case'];\n      PRECINCT_NAMES.forEach(name => {\n          precinctColorExpression.push(['==', ['get', 'name'], name], PRECINCT_COLORS[name]);\n      });\n      precinctColorExpression.push('#CCC'); \n\n     map.current.addLayer({\n        id: 'precincts-fill-layer', type: 'fill', source: 'precincts-data-source',\n        paint: { 'fill-color': '#ffffffff', 'fill-opacity': 0.15 }\n      });\n      map.current.addLayer({\n        id: 'precincts-shadow-layer', type: 'line', source: 'precincts-data-source',\n        paint: { 'line-color': 'rgba(0, 0, 0, 0.4)', 'line-width': 7, 'line-translate': [2, 2], 'line-blur': 4 }\n      });\n      map.current.addLayer({\n          id: 'precincts-outline-layer', type: 'line', source: 'precincts-data-source',\n          paint: { 'line-color': '#0868ac', 'line-width': 2.5, 'line-opacity': 0.9 }\n      });\n\n  // Precinct click handlers removed (no narrative panel)\n\n      map.current.on('mouseenter', 'precincts-fill-layer', () => { map.current.getCanvas().style.cursor = 'pointer'; });\n      map.current.on('mouseleave', 'precincts-fill-layer', () => { map.current.getCanvas().style.cursor = ''; });\n    });\n\n    return () => { if (map.current) { map.current.remove(); map.current = null; } };\n  }, []);\n\n  // Adjust map bounds on load\n  const adjustMapBounds = () => {\n    if (!map.current) return;\n    const bounds = [ [144.890, -37.850], [144.948, -37.816] ];\n    map.current.fitBounds(bounds, {\n      padding: { top: 20, bottom: 20, left: leftPanelWidth, right: rightPanelWidth },\n      duration: 2000, essential: true\n    });\n  };\n\n  // Adjust map bounds on window resize\n  useEffect(() => {\n    function debounce(fn, ms) {\n      let timer;\n      return function(...args) { clearTimeout(timer); timer = setTimeout(() => { fn.apply(this, args); }, ms); };\n    }\n    const debouncedAdjustBounds = () => {\n      if (!map.current) return;\n      const bounds = [ [144.890, -37.850], [144.948, -37.816] ];\n      map.current.fitBounds(bounds, { padding: { top: 20, bottom: 20, left: leftPanelWidth, right: rightPanelWidth }, duration: 0 });\n    };\n    const debouncedResizeListener = debounce(debouncedAdjustBounds, 150);\n    window.addEventListener('resize', debouncedResizeListener);\n    return () => window.removeEventListener('resize', debouncedResizeListener);\n  }, []);\n\n  // Toggle visibility of indicator layers\n  useEffect(() => {\n    if (!map.current || !map.current.isStyleLoaded()) return;\n    const allLayerIds = [\n      'education-layer',\n      'employment-layer',\n      'income-layer',\n      'pob-layer',\n      'occupation-layer'\n    ];\n  // Do NOT show preloaded indicator layers when selecting an indicator; we only visualize uploaded CSV output\n  const selectedLayerId = null;\n\n    if (map.current.getLayer('base-outline-layer')) {\n        map.current.setLayoutProperty('base-outline-layer', 'visibility', selectedIndicator ? 'visible' : 'none');\n    }\n\n    allLayerIds.forEach(layerId => {\n      if (map.current.getLayer(layerId)) {\n        const vis = layerId === selectedLayerId ? 'visible' : 'none';\n        map.current.setLayoutProperty(layerId, 'visibility', vis);\n  const outlineId = `${layerId}-hover-outline`;\n  const baseOutlineId = `${layerId}-base-outline`;\n  if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', vis);\n  if (map.current.getLayer(baseOutlineId)) map.current.setLayoutProperty(baseOutlineId, 'visibility', vis);\n      }\n    });\n  }, [selectedIndicator]);\n\n  // Keep a ref of the latest selected column for event handlers\n  useEffect(() => {\n    selectedColumnRef.current = selectedColumn || '';\n  }, [selectedColumn]);\n\n  // Handle uploaded GeoJSON rendering (depends on selectedColumn)\n  useEffect(() => {\n    if (!map.current || !map.current.isStyleLoaded()) return;\n    const sourceId = 'uploaded-geojson-source';\n    const fillId = 'uploaded-geojson-fill';\n    const outlineId = 'uploaded-geojson-outline';\n\n    if (!uploadedGeojson || !selectedColumn) {\n      if (map.current.getLayer(fillId)) map.current.setLayoutProperty(fillId, 'visibility', 'none');\n      if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', 'none');\n      setLegendInfo(null);\n      return;\n    }\n\n    const isNumeric = (val) => {\n      const n = Number(val);\n      return Number.isFinite(n);\n    };\n\n    const type = columnTypes[selectedColumn] || 'number';\n    const palette = (legendData[selectedIndicator]?.items || [\n      { color: '#fee5d9' }, { color: '#fcae91' }, { color: '#fb6a4a' }, { color: '#de2d26' }, { color: '#a50f15' }\n    ]).map(i => i.color);\n\n    let fillPaint;\n    let legend;\n    const fmt = new Intl.NumberFormat('en-AU', { maximumFractionDigits: 2 });\n    if (type === 'number') {\n      // Collect numeric values\n      const values = (uploadedGeojson.features || [])\n        .map(f => Number((f.properties || {})[selectedColumn]))\n        .filter(v => Number.isFinite(v))\n        .sort((a, b) => a - b);\n      let min = values.length ? values[0] : 0;\n      let max = values.length ? values[values.length - 1] : 1;\n      if (!Number.isFinite(min)) min = 0;\n      if (!Number.isFinite(max)) max = 1;\n\n      // Equal intervals into 5 classes\n      let step = (max - min) / 5;\n      if (!Number.isFinite(step) || step === 0) step = 1; // fallback for constant data\n      const breaks = [min + step, min + 2*step, min + 3*step, min + 4*step];\n\n      // Prepare a 5-color palette\n      const baseColors = palette.length >= 5 ? palette.slice(0, 5) : ['#fee5d9','#fcae91','#fb6a4a','#de2d26','#a50f15'];\n\n      // Step expression with 5 classes\n      const inputExpr = ['to-number', ['get', selectedColumn]];\n      const stepExpr = ['step', inputExpr, baseColors[0],\n        breaks[0], baseColors[1],\n        breaks[1], baseColors[2],\n        breaks[2], baseColors[3],\n        breaks[3], baseColors[4]\n      ];\n      fillPaint = { 'fill-color': stepExpr, 'fill-opacity': 0.6 };\n\n      // Legend items with ranges: [min,b1), [b1,b2), [b2,b3), [b3,b4), [b4,max]\n      const ranges = [\n        { from: min, to: breaks[0], color: baseColors[0] },\n        { from: breaks[0], to: breaks[1], color: baseColors[1] },\n        { from: breaks[1], to: breaks[2], color: baseColors[2] },\n        { from: breaks[2], to: breaks[3], color: baseColors[3] },\n        { from: breaks[3], to: max, color: baseColors[4] },\n      ];\n      const items = ranges.map(r => ({ color: r.color, label: `${fmt.format(r.from)} – ${fmt.format(r.to)}` }));\n      legend = { type: 'numeric', title: selectedColumn, items };\n    } else {\n      // Categorical palette\n      const catColors = ['#1f77b4','#ff7f0e','#2ca02c','#d62728','#9467bd','#8c564b','#e377c2','#7f7f7f','#bcbd22','#17becf','#aec7e8','#ffbb78'];\n      const uniques = Array.from(new Set((uploadedGeojson.features || []).map(f => (f.properties || {})[selectedColumn]).filter(v => v !== undefined && v !== null)));\n      const maxCats = 12;\n      const cats = uniques.slice(0, maxCats);\n      const matchExpr = ['match', ['get', selectedColumn]];\n      cats.forEach((c, i) => { matchExpr.push(c, catColors[i % catColors.length]); });\n      matchExpr.push('#cccccc'); // default color for others\n      fillPaint = { 'fill-color': matchExpr, 'fill-opacity': 0.6 };\n      legend = { type: 'categorical', title: selectedColumn, items: cats.map((c, i) => ({ color: catColors[i % catColors.length], label: String(c) })) };\n    }\n\n    if (map.current.getSource(sourceId)) {\n      map.current.getSource(sourceId).setData(uploadedGeojson);\n    } else {\n      map.current.addSource(sourceId, { type: 'geojson', data: uploadedGeojson });\n      map.current.addLayer({ id: fillId, type: 'fill', source: sourceId, paint: fillPaint });\n      map.current.addLayer({ id: outlineId, type: 'line', source: sourceId, paint: { 'line-color': '#cc8800', 'line-width': 1.2 } });\n    }\n    // Update paint if layer already exists (e.g., new upload with a different key/range)\n    if (map.current.getLayer(fillId)) {\n      map.current.setPaintProperty(fillId, 'fill-color', fillPaint['fill-color']);\n      map.current.setPaintProperty(fillId, 'fill-opacity', fillPaint['fill-opacity']);\n    }\n    if (map.current.getLayer(fillId)) map.current.setLayoutProperty(fillId, 'visibility', 'visible');\n    if (map.current.getLayer(outlineId)) map.current.setLayoutProperty(outlineId, 'visibility', 'visible');\n\n    // Bind interactive events once\n    if (!uploadedLayerEventsBound.current && map.current.getLayer(fillId)) {\n      const onEnter = () => { try { map.current.getCanvas().style.cursor = 'pointer'; } catch (_) {} };\n      const onLeave = () => { try { map.current.getCanvas().style.cursor = ''; } catch (_) {} };\n      const onClick = (e) => {\n        if (!e.features || !e.features.length) return;\n        const f = e.features[0];\n        const col = selectedColumnRef.current;\n        const val = f.properties && col in f.properties ? f.properties[col] : undefined;\n        const sa1 = (f.properties && (f.properties.SA1_CODE || f.properties.SA1_CODE21)) || '';\n        const html = `\n          <div style=\"font-weight:600;margin-bottom:4px;\">${col}</div>\n          <div>${val !== undefined && val !== null && `${val}`.trim() !== '' ? String(val) : 'N/A'}</div>\n          ${sa1 ? `<div style=\"margin-top:6px;color:#666;\">SA1: ${sa1}</div>` : ''}\n        `;\n        new maplibregl.Popup({ closeButton: true })\n          .setLngLat(e.lngLat)\n          .setHTML(html)\n          .addTo(map.current);\n      };\n      map.current.on('mouseenter', fillId, onEnter);\n      map.current.on('mouseleave', fillId, onLeave);\n      map.current.on('click', fillId, onClick);\n      uploadedLayerEventsBound.current = true;\n    }\n\n    setLegendInfo(legend);\n  }, [uploadedGeojson, selectedColumn]);\n\n  const handleFileChange = async (e) => {\n    const file = e.target.files?.[0];\n    if (!file || !selectedIndicator) return;\n    setUploading(true);\n    try {\n      const form = new FormData();\n      form.append('indicator', selectedIndicator.toLowerCase());\n      form.append('file', file);\n      const attempts = [];\n      const base = process.env.REACT_APP_API_URL;\n      if (base) attempts.push(`${base}/generate`);\n      // CRA dev proxy\n      attempts.push('/generate');\n      // Same host on port 8000\n      if (typeof window !== 'undefined') {\n        const proto = window.location.protocol;\n        const host = window.location.hostname;\n        attempts.push(`${proto}//${host}:8000/generate`);\n      }\n      // Explicit localhost\n      attempts.push('http://localhost:8000/generate');\n\n      let res;\n      let lastErr;\n      for (const url of attempts) {\n        try {\n          res = await fetch(url, { method: 'POST', body: form });\n          if (res.ok) break;\n          lastErr = new Error(`HTTP ${res.status} at ${url}`);\n        } catch (err) {\n          lastErr = err;\n        }\n      }\n      if (!res || !res.ok) throw lastErr || new Error('Upload failed');\n      const geojson = await res.json();\n      setUploadedGeojson(geojson);\n      // Derive columns and types from the first feature\n      const props = (geojson.features && geojson.features[0] && geojson.features[0].properties) ? geojson.features[0].properties : {};\n      const cols = Object.keys(props).filter(k => k !== 'SA1_CODE');\n      // Infer type per column\n      const inferTypes = {};\n      cols.forEach(col => {\n        const sample = (geojson.features || []).slice(0, 200).map(f => (f.properties || {})[col]).filter(v => v !== undefined && v !== null && `${v}`.trim() !== '');\n        const numericCount = sample.filter(v => Number.isFinite(Number(v))).length;\n        const ratio = sample.length ? (numericCount / sample.length) : 0;\n        inferTypes[col] = ratio >= 0.6 ? 'number' : 'string';\n      });\n      setAvailableColumns(cols);\n      setColumnTypes(inferTypes);\n      setSelectedColumn('');\n    } catch (err) {\n      console.error(err);\n      alert('Failed to generate GeoJSON from CSV. See console for details.');\n    } finally {\n      setUploading(false);\n      // Reset file input to allow re-upload of same file\n      e.target.value = '';\n    }\n  };\n\n  // (All narrative, search, and export logic removed)\n\n  // --- RENDER METHOD ---\n  return (\n    <div style={{ position: 'relative', width: '100%', height: 'calc(100vh - 78px)' }}>\n      <div ref={mapContainer} style={{ position: 'absolute', width: '100%', height: '100%' }} />\n      {/* Left overlay with dropdown, file upload, and column selector */}\n      <div style={{ position: 'absolute', top: '1rem', left: '1rem', backgroundColor: 'white', padding: '1rem', borderRadius: '0.5rem', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', width: '288px', zIndex: 10 }}>\n        <h3 style={{ fontSize: '1.125rem', fontWeight: 600, marginBottom: '0.5rem' }}>Select Indicator</h3>\n        <select\n          value={selectedIndicator || ''}\n          onChange={(e) => setSelectedIndicator(e.target.value || null)}\n          style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '0.375rem', marginBottom: '0.75rem' }}\n        >\n          <option value=\"\">Select…</option>\n          <option value=\"Education\">Education</option>\n          <option value=\"Employment\">Employment</option>\n          <option value=\"Income\">Income</option>\n          <option value=\"POB\">POB</option>\n          <option value=\"Occupation\">Occupation</option>\n        </select>\n  <label style={{ display: 'block', fontSize: '0.9rem', marginBottom: '0.5rem' }}>Upload CSV for selected indicator</label>\n  <input type=\"file\" accept=\".csv,text/csv\" onChange={handleFileChange} disabled={!selectedIndicator || uploading} />\n        {uploading && <div style={{ marginTop: '0.5rem', fontSize: '0.85rem' }}>Processing…</div>}\n        {uploadedGeojson && availableColumns.length > 0 && (\n          <div style={{ marginTop: '0.75rem' }}>\n            <label style={{ display: 'block', fontSize: '0.9rem', marginBottom: '0.5rem' }}>Select column to visualize</label>\n            <select\n              value={selectedColumn}\n              onChange={(e) => setSelectedColumn(e.target.value)}\n              style={{ width: '100%', padding: '0.5rem', border: '1px solid #D1D5DB', borderRadius: '0.375rem' }}\n            >\n              <option value=\"\">Choose a column…</option>\n              {availableColumns.map((col) => (\n                <option key={col} value={col}>\n                  {col}{columnTypes[col] === 'number' ? '' : ' (categorical)'}\n                </option>\n              ))}\n            </select>\n          </div>\n        )}\n      </div>\n\n      {/* Legend - bottom right */}\n      {legendInfo && selectedColumn && uploadedGeojson && (\n        <div style={{ position: 'absolute', right: '1rem', bottom: '1rem', backgroundColor: 'white', padding: '0.75rem', borderRadius: '0.5rem', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', width: '240px', zIndex: 10 }}>\n          <div style={{ fontWeight: 600, marginBottom: '0.5rem', fontSize: '0.95rem' }}>{legendInfo.title}</div>\n          <div style={{ display: 'grid', gridTemplateColumns: '20px 1fr', rowGap: '6px', columnGap: '8px' }}>\n            {legendInfo.items.map((it, idx) => (\n              <React.Fragment key={idx}>\n                <div style={{ width: '18px', height: '18px', backgroundColor: it.color, border: '1px solid #ddd', borderRadius: '2px' }} />\n                <div style={{ fontSize: '0.9rem', color: '#333' }}>{it.label}</div>\n              </React.Fragment>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n// --- END: MAP COMPONENT ---"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}